CREATE TEMPORARY TABLE temp_user_profile (user_id SERIAL PRIMARY KEY,
                                            public boolean,
                                            completion_percentage integer,
                                            gender boolean,
                                            region text,
                                            last_login date,
                                            registration date,
                                            age integer,
                                            body text,
                                            I_am_working_in_field text,
                                            spoken_languages text,
                                            hobbies text,
                                            I_most_enjoy_good_food text,
                                            pets text,
                                            body_type text,
                                            my_eyesight text,
                                            eye_color text,
                                            hair_color text,
                                            hair_type text,
                                            completed_level_of_education text,
                                            favourite_color text,
                                            relation_to_smoking text,
                                            relation_to_alcohol text,
                                            sign_in_zodiac text,
                                            on_pokec_i_am_looking_for text,
                                            love_is_for_me text,
                                            relation_to_casual_sex text,
                                            my_partner_should_be text,
                                            marital_status text,
                                            children text,
                                            relation_to_children text,
                                            I_like_movies text,
                                            I_like_watching_movie text,
                                            I_like_music text,
                                            I_mostly_like_listening_to_music text,
                                            the_idea_of_good_evening text,
                                            I_like_specialties_from_kitchen text,
                                            fun text,
                                            I_am_going_to_concerts text,
                                            my_active_sports text,
                                            my_passive_sports text,
                                            profession text,
                                            I_like_books text,
                                            life_style text,
                                            music text,
                                            cars text,
                                            politics text,
                                            relationships text,
                                            art_culture text,
                                            hobbies_interests text,
                                            science_technologies text,
                                            computers_internet text,
                                            education text,
                                            sport text,
                                            movies text,
                                            travelling text,
                                            health text,
                                            companies_brands text,
                                            more text,
                                            extra_column text);


COPY temp_user_profile FROM '{0}' WITH (FORMAT 'csv', DELIMITER E'\t', ESCAPE '\', NULL 'null');

LOCK TABLE user_profile IN EXCLUSIVE MODE;
INSERT INTO user_profile(user_id, public, completion_percentage, gender, region, last_login, registration, age, data)
    SELECT user_id,
       public,
       completion_percentage,
       gender,
       region,
       last_login,
       registration,
       age,
       row_to_json(
            (SELECT d
                FROM
                    (SELECT
                        body,
                        I_am_working_in_field,
                        spoken_languages, hobbies,
                        I_most_enjoy_good_food,
                        pets,
                        body_type,
                        my_eyesight,
                        eye_color,
                        hair_color,
                        hair_type,
                        completed_level_of_education,
                        favourite_color,
                        relation_to_smoking,
                        relation_to_alcohol,
                        sign_in_zodiac,
                        on_pokec_i_am_looking_for,
                        love_is_for_me,
                        relation_to_casual_sex,
                        my_partner_should_be,
                        marital_status, children,
                        relation_to_children,
                        I_like_movies,
                        I_like_watching_movie,
                        I_like_music,
                        I_mostly_like_listening_to_music,
                        the_idea_of_good_evening,
                        I_like_specialties_from_kitchen,
                        fun,
                        I_am_going_to_concerts,
                        my_active_sports,
                        my_passive_sports,
                        profession,
                        I_like_books,
                        life_style,
                        music,
                        cars,
                        politics,
                        relationships,
                        art_culture,
                        hobbies_interests,
                        science_technologies,
                        computers_internet,
                        education,
                        sport,
                        movies,
                        travelling,
                        health,
                        companies_brands,
                        more
                    FROM
                        temp_user_profile
                    WHERE
                        temp_user_profile.user_id = s.user_id) d))::jsonb
    FROM temp_user_profile s;
